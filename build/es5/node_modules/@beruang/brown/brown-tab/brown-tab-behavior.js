define(["exports","../../../@polymer/polymer/lib/utils/mixin.js","../../../@polymer/polymer/lib/utils/flattened-nodes-observer.js","../../../@polymer/polymer/lib/utils/render-status.js","../../../@polymer/polymer/lib/utils/gestures.js"],function(_exports,_mixin,_flattenedNodesObserver,_renderStatus,Gestures){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.BrownTabBehavior=void 0;Gestures=babelHelpers.interopRequireWildcard(Gestures);/**
@license
Copyright (c) 2019 The Beruang Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
https://github.com/DatatransInformatika/beruang/blob/master/LICENSE.txt The complete set of authors may be found at
https://github.com/DatatransInformatika/beruang/blob/master/AUTHORS.txt The complete set of contributors may be
found at https://github.com/DatatransInformatika/beruang/blob/master/CONTRIBUTORS.txt
*/ /**
`BrownTabBehavior`
@polymerBehavior BrownTabBehavior
*/var internalBrownTabBehavior=function internalBrownTabBehavior(base){return(/*#__PURE__*/function(_base){babelHelpers.inherits(_class,_base);function _class(){babelHelpers.classCallCheck(this,_class);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(_class).apply(this,arguments))}babelHelpers.createClass(_class,[{key:"ready",value:function ready(){var _this=this;babelHelpers.get(babelHelpers.getPrototypeOf(_class.prototype),"ready",this).call(this);Gestures.addListener(this,"tap",function(e){//v
var path=e.path||e.composedPath&&e.composedPath(),tabItem=_this._tabItem(path);if(!tabItem){//tap bukan berasal dari tabtItem, return cepat
return}var closing="tab-closer"==path[0].id;//apakah closing?
if(closing){_this._onTabClosing(tabItem)}else{if(tabItem.active){//tabItem sudah berstatus aktif
return;//tidak perlu mengaktifkan tabItem
}_this._onTabActiving(tabItem)}});this.addEventListener("active-changed",function(e){//v
_this._onTabActiveChanged(e.target,e.detail.active)});////memantau perubahan dalam #header-slot untuk perlu-tidaknya tab-item scroll ditampilkan
var slot=this.shadowRoot.querySelector("#header-slot"),fMonitorCallback=function fMonitorCallback(info){//FlattenedNodesObserver memantau slot
if(0<info.addedNodes.length||0<info.removedNodes.length){//jika tab item ditambah atau dihapus
var f=function f(){//beri waktu posisi tab item stabil
this._evaluateScroll();//perlu tampil scroll kanan, kiri, atau dua-duanya
};(0,_renderStatus.afterNextRender)(_this,f)}};//slot -> slot name:header-slot//v
this._observer=new _flattenedNodesObserver.FlattenedNodesObserver(slot,fMonitorCallback)}//ready()
},{key:"connectedCallback",value:function connectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(_class.prototype),"connectedCallback",this).call(this);this._fWndResize=this._fWndResize||this._evaluateScroll.bind(this);window.addEventListener("resize",this._fWndResize)}},{key:"disconnectedCallback",value:function disconnectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(_class.prototype),"disconnectedCallback",this).call(this);window.removeEventListener("resize",this._fWndResize)}},{key:"_tabItem",value:function _tabItem(path){for(var i=0;i<path.length;i++){if("BROWN-TABITEM-DESKTOP"==path[i].nodeName){return path[i]}}return null}////////////////////////fungsi untuk menggeser tab lain (next / previous), jika suatu tab ditutup:START/////////////
},{key:"_getTabItemSibling",value:function _getTabItemSibling(el/*tab item*/,callback/*fungsi berisi syarat pencarian*/){//v
var f=function f(sib){return"BROWN-TABITEM-DESKTOP"==sib.nodeName&&(//syarat 1: sibling harus <brown-tab-desktop></brown-tab-desktop>
!callback||callback(sib));//syarat 2: jika tidak ada callback atau
//callback return true, maka sibling memenuhi syarat
},sibling=this._getLightDOM(el.nextElementSibling,!0,f);//forward
if(!sibling){sibling=this._getLightDOM(el.previousElementSibling,!1,f);//backward
}return sibling}//_getTabItemSibling(el, callback)
////////////////////////fungsi untuk menggeser tab lain (next / previous), jika suatu tab ditutup:END/////////////
},{key:"_getLightDOM",value:function _getLightDOM(startEl,forward,callback){//v
var el=startEl;while(el){if(callback(el)){//x
return el;//x
}el=forward?el.nextElementSibling:el.previousElementSibling}return null}//header item scrolling:BEGIN
},{key:"_ensureItemVisible",value:function _ensureItemVisible(tabItem){//v
var container=this.shadowRoot.querySelector("#header-item"),right=tabItem.offsetLeft+tabItem.offsetWidth-container.scrollLeft,left=tabItem.offsetLeft-container.scrollLeft,scroll=0;if(right>container.offsetWidth){scroll=right-container.offsetWidth}else if(0>left){scroll=left}if(0!=scroll){container.scrollLeft+=scroll;this._evaluateScroll()}}},{key:"_evaluateScroll",value:function _evaluateScroll(){var _this2=this;//v
setTimeout(function(){_this2._evaluateScrollDo("#post-scroll");_this2._evaluateScrollDo("#pre-scroll")},100)}},{key:"_evaluateScrollDo",value:function _evaluateScrollDo(scrollerId){//v
var container=this.shadowRoot.querySelector("#header-item"),scroller=this.shadowRoot.querySelector(scrollerId),visible=!1;if("#post-scroll"==scrollerId){//_getLightDOM(startEl, forward, callback)
var tabItem=this._getLightDOM(this.lastElementChild,!1,function(el){//get last tabItem
return"BROWN-TABITEM-DESKTOP"==el.nodeName});if(tabItem){var right=tabItem.offsetLeft+tabItem.offsetWidth-container.scrollLeft;visible=right>container.offsetWidth}}else if("#pre-scroll"==scrollerId){var _tabItem2=this._getLightDOM(this.firstElementChild,!0,function(el){//get first tabItem
return"BROWN-TABITEM-DESKTOP"==el.nodeName});if(_tabItem2){var left=_tabItem2.offsetLeft-container.scrollLeft;visible=0>left}}if(visible){scroller.classList.add("scroll")}else{scroller.classList.remove("scroll")}}//_evaluateScrollDo(scrollerId)
},{key:"_preScroll",value:function _preScroll(e){//v
var tabItem=this._getLightDOM(this.firstElementChild,!0,function(el){//search first tabItem
return"BROWN-TABITEM-DESKTOP"==el.nodeName});if(tabItem){var container=this.shadowRoot.querySelector("#header-item"),offset=tabItem.offsetLeft-container.scrollLeft;if(0>offset){offset=Math.max(offset,-1*(container.offsetWidth/5));container.scrollLeft+=offset;this._evaluateScroll();//selesai scroll, diperiksa masih butuh scroll atau tidak
}}}},{key:"_postScroll",value:function _postScroll(e){//v
var tabItem=this._getLightDOM(this.lastElementChild,!1,function(el){//search last tabItem
return"BROWN-TABITEM-DESKTOP"==el.nodeName});if(tabItem){var container=this.shadowRoot.querySelector("#header-item"),right=tabItem.offsetLeft+tabItem.offsetWidth-container.scrollLeft,offset=right-container.offsetWidth;if(0<offset){offset=Math.min(offset,container.offsetWidth/5);container.scrollLeft+=offset;this._evaluateScroll();//selesai scroll, diperiksa masih butuh scroll atau tidak
}}}//header item scrolling:END
},{key:"_onTabClosing",value:function _onTabClosing(tabItem){throw new ReferenceError("_onTabClosing must be implemented by child class")}},{key:"_onTabActiving",value:function _onTabActiving(tabItem){throw new ReferenceError("_onTabActiving must be implemented by child class")}},{key:"_onTabActiveChanged",value:function _onTabActiveChanged(tabItem,active){throw new ReferenceError("_onTabActiveChanged must be implemented by child class")}}],[{key:"properties",get:function get(){return{dynamicTab:{type:Boolean,value:!1,reflectToAttribute:!0}}}}]);return _class}(base))},BrownTabBehavior=(0,_mixin.dedupingMixin)(internalBrownTabBehavior);_exports.BrownTabBehavior=BrownTabBehavior});