define(["../../@polymer/polymer/polymer-element.js","../../@polymer/polymer/lib/utils/flattened-nodes-observer.js"],function(_polymerElement,_flattenedNodesObserver){"use strict";function _templateObject_69ff7950ae8311e9b4740720630ff31c(){var data=babelHelpers.taggedTemplateLiteral(["\n      <style>\n        :host {\n          display:none;\n        }\n      </style>\n      <slot name=\"tuple\"></slot>\n    "]);_templateObject_69ff7950ae8311e9b4740720630ff31c=function _templateObject_69ff7950ae8311e9b4740720630ff31c(){return data};return data}var BlackStore=/*#__PURE__*/function(_PolymerElement){babelHelpers.inherits(BlackStore,_PolymerElement);function BlackStore(){babelHelpers.classCallCheck(this,BlackStore);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(BlackStore).apply(this,arguments))}babelHelpers.createClass(BlackStore,[{key:"ready",value:function ready(){var _this=this;babelHelpers.get(babelHelpers.getPrototypeOf(BlackStore.prototype),"ready",this).call(this);var slot=this.shadowRoot.querySelector("slot"),fMonitorCallback=function fMonitorCallback(info){var i,primaryValueArr=_this._primaryValueArray();for(i=0;i<info.addedNodes.length;i++){var el=info.addedNodes[i],primaryValue=_this._checkTuple(el.obj,primaryValueArr);primaryValueArr.push(primaryValue);var record=_this._createRecord(el.obj);_this.push("recordset",record)}//menghapus records
for(i=0;i<info.removedNodes.length;i++){var _el=info.removedNodes[i],_primaryValue=_el.obj[_this.key],index=_this._recordIndex(_primaryValue);if(0<=index){_this.splice("recordset",index,1)}}};this._observer=new _flattenedNodesObserver.FlattenedNodesObserver(slot,fMonitorCallback)}},{key:"addTuple",value:function addTuple(index,tuple){var primaryValueArr=this._primaryValueArray(),recordLen=this.recordset.length;this._addTuple(index,tuple,primaryValueArr,recordLen)}},{key:"addTuples",value:function addTuples(index,tuples){for(var primaryValueArr=this._primaryValueArray(),recordLen=this.recordset.length,i=0,primaryValue;i<tuples.length;i++){primaryValue=this._addTuple(index++,tuples[i],primaryValueArr,recordLen++);primaryValueArr.push(primaryValue)}}},{key:"removeTuple",value:function removeTuple(id){var index=this._recordIndex(id);if(0<=index){this.splice("recordset",index,1)}}},{key:"removeTuples",value:function removeTuples(ids){for(var i=0;i<ids.length;i++){this.removeTuple(ids[i])}}},{key:"sortTuples",value:function sortTuples(fSort){//this.recordset.sort(fSort);
for(var len=this.recordset.length,i=0;i<len-1;i++){for(var championIndex=i,championRecord=this.recordset[i],championTuple=this._mergeTuple(championRecord),challengerIndex=i+1,challengerRecord=this.recordset[i+1],challengerTuple=this._mergeTuple(challengerRecord),j=i+2;j<len;j++){var record=this.recordset[j],tuple=this._mergeTuple(record);if(0<fSort(challengerTuple,tuple)){challengerIndex=j;challengerRecord=record;challengerTuple=this._mergeTuple(record)}}if(0<fSort(championTuple,challengerTuple)){this.recordset[championIndex]=challengerRecord;this.recordset[challengerIndex]=championRecord}}this.notifyPath("recordset")}},{key:"_addTuple",value:function _addTuple(index,tuple,primaryValueArr,recordLen){var primaryValue=this._checkTuple(tuple,primaryValueArr),record=this._createRecord(tuple);if(0>index||index>=recordLen){this.push("recordset",record)}else{this.splice("recordset",index,0,record)}return primaryValue}},{key:"_createRecord",value:function _createRecord(tuple){return{tuple:tuple,changeset:{}}}},{key:"_recordIndex",value:function _recordIndex(primaryValue){for(var index=-1,i=0;i<this.recordset.length;i++){var record=this.recordset[i],value=this._recordValue(record,this.key);if(primaryValue==value){index=i;break}}return index}},{key:"_recordValue",value:function _recordValue(record,key){return record.changeset.hasOwnProperty(key)?record.changeset[key]:record.tuple[key]}},{key:"_mergeTuple",value:function _mergeTuple(record){for(var ks=Object.keys(record.tuple),tuple={},i=0,k;i<ks.length;i++){k=ks[i];tuple[k]=this._recordValue(record,k)}return tuple}},{key:"_checkTuple",value:function _checkTuple(tuple,primaryValueArr){if(!tuple.hasOwnProperty(this.key)){throw new ReferenceError("tuple must have key property ["+this.key+"]")}var primaryValue=tuple[this.key],index=primaryValueArr.indexOf(primaryValue);if(0<=index){throw new ReferenceError("duplicate primary value ["+primaryValue+"]")}return primaryValue}},{key:"_primaryValueArray",value:function _primaryValueArray(){for(var primaryValueArr=[],i=0,value;i<this.recordset.length;i++){value=this._recordValue(this.recordset[i],this.key);primaryValueArr.push(value)}return primaryValueArr}}],[{key:"template",get:function get(){return(0,_polymerElement.html)(_templateObject_69ff7950ae8311e9b4740720630ff31c())}},{key:"properties",get:function get(){return{key:{type:String},recordset:{type:Array,value:function value(){return[]},readOnly:!0}}}}]);return BlackStore}(_polymerElement.PolymerElement);window.customElements.define("black-store",BlackStore)});