define(["exports"],function(_exports){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.Record=void 0;var Record=/*#__PURE__*/function(){function Record(tuple){babelHelpers.classCallCheck(this,Record);this.tuple=tuple;this.changeset={}}babelHelpers.createClass(Record,[{key:"getValue",value:function getValue(key){this._verifyKey(key);return this.changeset.hasOwnProperty(key)?this.changeset[key]:this.tuple[key]}},{key:"setValue",value:function setValue(key,value){this._verifyKey(key);if(value==this.tuple[key]){delete this.changeset[key]}else{this.changeset[key]=value}}},{key:"commit",value:function commit(){for(var ks=Object.keys(this.changeset),i=0;i<ks.length;i++){this._commitValue(ks[i])}}},{key:"commitValue",value:function commitValue(key){if(this.isKeyDirty(key)){this._commitValue(key)}}},{key:"rollback",value:function rollback(){for(var ks=Object.keys(this.changeset),i=0;i<ks.length;i++){this.rollbackValue(ks[i])}}},{key:"rollbackValue",value:function rollbackValue(key){delete this.changeset[key]}},{key:"isDirty",value:function isDirty(){var ks=Object.keys(this.changeset);return 0<ks.length}},{key:"isKeyDirty",value:function isKeyDirty(key){return this.changeset.hasOwnProperty(key)}},{key:"_commitValue",value:function _commitValue(key){this.tuple[key]=this.changeset[key];delete this.changeset[key]}},{key:"mergeTuple",value:function mergeTuple(){for(var ks=Object.keys(this.tuple),tuple={},i=0;i<ks.length;i++){tuple[ks[i]]=this.getValue(ks[i])}return tuple}},{key:"_verifyKey",value:function _verifyKey(key){if(!this.tuple.hasOwnProperty(key)){throw new ReferenceError("invalid key ["+key+"]")}}}]);return Record}();_exports.Record=Record});